<% content_for(:title) do%>
	Dynamic Specials: MuVi2 Database
<% end %>

<%- session[:special_channel] = params[:channel] %>

<fieldset>
	<legend>Dynamic Specials</legend>
		<% form_tag dynamic_specials_path, :method =>'get' do %>
			<p>
				<%= text_field_tag :search, params[:search], :size => 45 %>
				<%= submit_tag "Search", :name => nil %>
			</p>
		Channel <%= select_tag :channel, options_for_select(@channel_display.insert(0,"All"), 
														params[:channel]),{:onchange => 'this.form.submit()'}%><br/>
		<%= label_tag :show_duplicates, "Show illegal duplicates only" %>
		<%= check_box_tag :show_duplicates, value ="1", params[:show_duplicates],{:onchange => 'this.form.submit()'} %><br/>
		<%= label_tag :show_duplicates, "Show all (including past last use)" %>
		<%= check_box_tag :show_all, value ="1", params[:show_all],{:onchange => 'this.form.submit()'} %><br/>
		<% end %>
</fieldset>

<br />
<%= link_to 'New Dynamic Special', new_dynamic_special_path %>
<br />

<% if !@show_duplicates %>
  <%= will_paginate @dynamic_specials %>
<% end %>
<table>
  <tr>
    <th>Name</th>
    <th>Channel</th>
    <th>Sponsor</th>
    <th>Page 16:9</th>
    <th>Clear Down 16:9</th>
    <th>Page 4:3</th>
    <th>Clear Down 4:3</th>
    <th>Duration</th>
    <th>No. Fields</th>
  </tr>

<% @dynamic_specials.each do |dynamic_special| %>
  <% if (!@show_duplicates) || (@show_duplicates && (dynamic_special.duplicate_message != '')) %>
    <tr>
      <td><%=h dynamic_special.name %></td>
      <td><%=h dynamic_special.channel_name %></td>
      <td><%=h dynamic_special.sponsor %></td>
      <td><%=h dynamic_special.page %></td>
      <td><%=h dynamic_special.clear_down_page_number %></td>
      <td><%=h dynamic_special.page_43 %></td>
      <td><%=h dynamic_special.clear_down_page_number_43 %></td>
      <td><%=h dynamic_special.clear_down_duration %></td>    
      <td><%=h dynamic_special.special_fields.count %></td>
      <td><%= link_to 'Show', dynamic_special %></td>
      <td><%= link_to 'Edit', edit_dynamic_special_path(dynamic_special) %></td>
      <td><%= link_to 'Destroy', dynamic_special, :confirm => 'Are you sure?', :method => :delete %></td>
      <td><%= link_to 'Duplicate', :controller => :dynamic_specials, :action => :duplicate, :id => dynamic_special %></td>
      <td><%=h dynamic_special.duplicate_message %></td>
    </tr>
  <% end %>
<% end %>

</table>

<br />

<% if !@show_duplicates %>
  <%= will_paginate @dynamic_specials %>
<% end %>

<%= link_to 'New Dynamic Special', new_dynamic_special_path %>
